<!-- Add this to your existing CEO dashboard template in the metrics section -->
<div class="executive-kpi-row">
    <div class="kpi-card primary">
        <div class="kpi-header">
            <div class="kpi-icon">
                <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="kpi-trend {% if revenue_growth > 0 %}positive{% elif revenue_growth < 0 %}negative{% else %}neutral{% endif %}">
                <i class="fas fa-arrow-{% if revenue_growth > 0 %}up{% elif revenue_growth < 0 %}down{% else %}right{% endif %}"></i>
                {{ revenue_growth }}%
            </div>
        </div>
        <div class="kpi-content">
            <div class="kpi-value">${{ current_year_stats.total_revenue|floatformat:0|default:"0" }}</div>
            <div class="kpi-label">Total Revenue ({{ current_year }})</div>
            <div class="kpi-comparison">vs ${{ previous_year_stats.total_revenue|floatformat:0|default:"0" }} last year</div>
        </div>
    </div>

    <div class="kpi-card success">
        <div class="kpi-header">
            <div class="kpi-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="kpi-trend {% if profit_growth > 0 %}positive{% elif profit_growth < 0 %}negative{% else %}neutral{% endif %}">
                <i class="fas fa-arrow-{% if profit_growth > 0 %}up{% elif profit_growth < 0 %}down{% else %}right{% endif %}"></i>
                {{ profit_growth }}%
            </div>
        </div>
        <div class="kpi-content">
            <div class="kpi-value">{{ current_year_stats.avg_profit_margin|floatformat:1|default:"0" }}%</div>
            <div class="kpi-label">Average Profit Margin</div>
            <div class="kpi-comparison">Industry leading performance</div>
        </div>
    </div>

    <div class="kpi-card info">
        <div class="kpi-header">
            <div class="kpi-icon">
                <i class="fas fa-calendar"></i>
            </div>
            <div class="kpi-trend positive">
                <i class="fas fa-arrow-up"></i>
                Live Data
            </div>
        </div>
        <div class="kpi-content">
            <div class="kpi-value">{{ current_quarter }}</div>
            <div class="kpi-label">Current Quarter</div>
            <div class="kpi-comparison">Last updated: {{ latest_data.date|default:"Today" }}</div>
        </div>
    </div>

    <div class="kpi-card warning">
        <div class="kpi-header">
            <div class="kpi-icon">
                <i class="fas fa-trending-up"></i>
            </div>
            <div class="kpi-trend positive">
                <i class="fas fa-arrow-up"></i>
                Best Day
            </div>
        </div>
        <div class="kpi-content">
            <div class="kpi-value">${{ top_performing_days.0.revenue|floatformat:0|default:"0" }}</div>
            <div class="kpi-label">Highest Revenue Day</div>
            <div class="kpi-comparison">{{ top_performing_days.0.date|default:"N/A" }}</div>
        </div>
    </div>
</div>

<!-- Add this script to make charts dynamic -->
<script>
// Dynamic chart data from Django
const monthlyData = {{ monthly_data|safe }};

// Update your existing chart initialization
function initCharts() {
    const chartCanvas = document.getElementById('revenueAnalysisChart');
    if (chartCanvas) {
        const ctx = chartCanvas.getContext('2d');
        
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: monthlyData.map(item => item.month),
                datasets: [
                    {
                        label: 'Revenue',
                        data: monthlyData.map(item => item.revenue),
                        borderColor: '#4299e1',
                        backgroundColor: 'rgba(66, 153, 225, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Profit',  
                        data: monthlyData.map(item => item.profit),
                        borderColor: '#48bb78',
                        backgroundColor: 'rgba(72, 187, 120, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toLocaleString();
                            }
                        }
                    }
                }
            }
        });
    }
}
</script>
